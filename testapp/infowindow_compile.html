<!doctype html>
<html ng-app="myapp">
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script src="http://maps.google.com/maps/api/js"></script>
<script src="lib/angular.js"></script>
<!--
<script src="../build/scripts/ng-map.min.js"></script>
-->
<script src="../app.js"></script>
<script src="../controllers/map-controller.js"></script>
<script src="../services/ng-map.js"></script>
<script src="../services/geo-coder.js"></script>
<script src="../services/navigator-geolocation.js"></script>
<script src="../services/attr2-map-options.js"></script>
<script src="../filters/camel-case.js"></script>
<script src="../filters/jsonize.js"></script>
<script src="../directives/map.js"></script>
<script src="../directives/marker.js"></script>
<script src="../directives/shape.js"></script>
<script src="../directives/info-window.js"></script>
<script>
var app = app || angular.module('myapp', ['ngMap']);
app.controller('MyCtrl', function($compile, NgMap) {
  var vm = this;
  NgMap.getMap().then(function(map) {
    vm.map = map;
  });
  vm.stores = {
    foo: { position:[41, -87], items: [1,2,3,4]},
    bar:{ position:[41, -83], items: [5,6,7,8]}
  };
  vm.showStore = function(evt, id) {
    vm.store = vm.stores[id];
    vm.showInfoWindow.apply(this, [evt, 'foo']);
  };
  vm.mouseover = function() {
    console.log('mouseover');
  };
});
</script>
</head>
<body ng-controller="MyCtrl as vm">
  <map center="41,-87" zoom="3">

    <info-window id="foo" on-mouseover="vm.mouseover()">
      <div ng-non-bindable="">
        Lat/Lng: {{this.getPosition()}}<br/>
        <ul>
          <li ng-repeat='item in vm.store.items'>{{item}}</li>
        </ul>
      </div>
    </info-window>

    <marker ng-repeat="(id, store) in vm.stores" id="{{id}}"
      position="{{store.position}}"
      on-click="vm.showStore(event, id)"></marker>

    <info-window id="bar" on-mouseover="vm.mouseover()">
      <div ng-non-bindable="">
        Lat: {{this.getPosition().lat()}}<br/>
        Lng: {{this.getPosition().lng()}}<br/>
      </div>
    </info-window>

    <marker position="41, -79" on-click="vm.map.showInfoWindow('bar')" />
  </map>
</body>
</html>
